# <span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>Pytest结合Allure操作</span>

## <span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>1.Allure环境搭建</span>

1. <span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>下载allure.zip</span>
2. <span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>解压allure.zip到一个文件目录中</span>
3. <span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>将D:\allure-2.13.3\bin路径添加环境变量path中</span>
4. <span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>pip install allure-pytest</span>
5. <span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>验证(cmd下输入allure)</span>

## <span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>2.Pytest结合Allure操作</span>

<span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>#执行单元测试，生成Allure报告需要的数据存在/tmp目录</span>

<span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>pytest -sq  --alluredir=../report/tmp</span>

<span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>#清除历史测试用例结果</span>

<span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>'--alluredir','../report/tmp','--clean-alluredir'</span>

<span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>执行命令，生成测试报告</span>

<span style='color:blue;background:背景颜色;font-size:文字大小;font-family:体;'>allure generate ../report/tmp -o ../report/report --clean</span>

```python
import pytest
import os
import allure
#2.封装测试类
class TestLogin:#登录模块
    #该测试类-前置条件---初始化
    def setup_class(self):
        print('执行测试类之前，我需要执行操作-----')
    def test_login01(self):
        print('----test_login01----')
        assert 1+1 ==2#断言
    
    def test_login02(self):
        print('----test_login02----')
        assert 1+1 ==3#断言
    def teardown_class(self):
        print('-----该测试类环境清除’)
        
if__name__=='__main__':
    #需要打印的对应信息 -s
    #1  --alluredir  存放目录
    pytest.main(['test_func01.py','-s']，'--alluredir','../report/tmp')
    #2 allure generate allure 报告 cmd指令---os.system()
    #os.system('allure generate 报告需要的数据' -o 报告存放的目录 --clean')     
    os.system('allure generate ../report/tmp -o ../report/report --clean')          
              
              
              
```

<span style='color:red;background:背景颜色;font-size:文字大小;font-family:体;'>#allure定制化分层分级</span>

```python
import pytest
import os
import allure
#2.封装测试类
@allure.feature('登录模块') #-级标签
class TestLogin:#登录模块
    #该测试类-前置条件---初始化
    def setup_class(self):#看业务本身---可选项
        print('执行测试类之前，我需要执行操作-----')
        
    @allure.story('登录login01') #二级标签
    @allure.title('login01')
    @pytest.mark.parametrize('a','b',[(1,2),(3,4),(5,6)])#('变量名'，[1,2,3])
    def test_login01(self,a,b):
        print('----test_login01----')
        assert a+b ==2#断言
        
    @allure.story('登录login02') #二级标签 
    def test_login02(self):
        print('----test_login02----')
        assert 1+1 ==3#断言
    def teardown_class(self):
        print('-----该测试类环境清除’)
        
if__name__=='__main__':
    #需要打印的对应信息 -s
    #1  --alluredir  存放目录 --clean-alluredir 清除测试用例结果，保证报告是最新的
    pytest.main(['test_func01.py','-s','--alluredir','../report/tmp','--clean-alluredir'])
    #2 allure generate allure 报告 cmd指令---os.system()
    #os.system('allure generate 报告需要的数据' -o 报告存放的目录 --clean')     
    os.system('allure generate ../report/tmp -o ../report/report --clean')   
```

